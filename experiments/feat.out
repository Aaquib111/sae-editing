WARNING:root:You tried to specify center_unembed=True for a model using logit softcap, but this can't be done! Softcapping is not invariant upon adding a constantSetting center_unembed=False instead.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:20<00:20, 20.95s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00,  9.35s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00, 11.09s/it]
WARNING:root:You are not using LayerNorm, so the writing weights can't be centered! Skipping
/root/sae-editing/experiments/feature_sparsities.py:31: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  correct = rep_wmdp.groupby('question_id').apply(lambda x: (x['mcq_answer'] == x['pred'].str.strip()).sum() >= 4)
Loaded pretrained model google/gemma-2-2b-it into HookedTransformer
  0%|          | 0/21 [00:00<?, ?it/s]  5%|▍         | 1/21 [00:03<01:07,  3.35s/it] 10%|▉         | 2/21 [00:05<00:53,  2.83s/it] 14%|█▍        | 3/21 [00:08<00:47,  2.65s/it] 19%|█▉        | 4/21 [00:10<00:43,  2.57s/it] 24%|██▍       | 5/21 [00:13<00:40,  2.52s/it] 29%|██▊       | 6/21 [00:15<00:37,  2.49s/it] 33%|███▎      | 7/21 [00:17<00:34,  2.47s/it] 38%|███▊      | 8/21 [00:20<00:31,  2.46s/it] 43%|████▎     | 9/21 [00:22<00:29,  2.44s/it] 48%|████▊     | 10/21 [00:25<00:26,  2.43s/it] 52%|█████▏    | 11/21 [00:27<00:24,  2.43s/it] 57%|█████▋    | 12/21 [00:30<00:21,  2.43s/it] 62%|██████▏   | 13/21 [00:32<00:19,  2.43s/it] 67%|██████▋   | 14/21 [00:34<00:16,  2.43s/it] 71%|███████▏  | 15/21 [00:37<00:14,  2.42s/it] 76%|███████▌  | 16/21 [00:39<00:12,  2.42s/it] 81%|████████  | 17/21 [00:42<00:09,  2.42s/it] 86%|████████▌ | 18/21 [00:44<00:07,  2.42s/it] 90%|█████████ | 19/21 [00:47<00:04,  2.43s/it] 95%|█████████▌| 20/21 [00:49<00:02,  2.43s/it]100%|██████████| 21/21 [00:49<00:00,  1.82s/it]100%|██████████| 21/21 [00:49<00:00,  2.38s/it]
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:02<02:02,  2.08s/it]  3%|▎         | 2/60 [00:04<02:01,  2.09s/it]  5%|▌         | 3/60 [00:06<01:59,  2.09s/it]  7%|▋         | 4/60 [00:08<01:56,  2.09s/it]  8%|▊         | 5/60 [00:10<01:54,  2.08s/it] 10%|█         | 6/60 [00:12<01:52,  2.08s/it] 12%|█▏        | 7/60 [00:14<01:50,  2.08s/it] 13%|█▎        | 8/60 [00:16<01:48,  2.09s/it] 15%|█▌        | 9/60 [00:18<01:46,  2.08s/it] 17%|█▋        | 10/60 [00:20<01:44,  2.08s/it] 18%|█▊        | 11/60 [00:22<01:42,  2.08s/it] 20%|██        | 12/60 [00:25<01:40,  2.08s/it] 22%|██▏       | 13/60 [00:27<01:37,  2.08s/it] 23%|██▎       | 14/60 [00:29<01:35,  2.08s/it] 25%|██▌       | 15/60 [00:31<01:33,  2.08s/it] 27%|██▋       | 16/60 [00:33<01:31,  2.08s/it] 28%|██▊       | 17/60 [00:35<01:29,  2.08s/it] 30%|███       | 18/60 [00:37<01:27,  2.08s/it] 32%|███▏      | 19/60 [00:39<01:25,  2.08s/it] 33%|███▎      | 20/60 [00:41<01:23,  2.08s/it] 35%|███▌      | 21/60 [00:43<01:20,  2.08s/it] 37%|███▋      | 22/60 [00:45<01:19,  2.08s/it] 38%|███▊      | 23/60 [00:47<01:16,  2.08s/it] 40%|████      | 24/60 [00:49<01:14,  2.08s/it] 42%|████▏     | 25/60 [00:52<01:12,  2.08s/it] 43%|████▎     | 26/60 [00:54<01:10,  2.08s/it] 45%|████▌     | 27/60 [00:56<01:08,  2.08s/it] 47%|████▋     | 28/60 [00:58<01:06,  2.08s/it] 48%|████▊     | 29/60 [01:00<01:04,  2.08s/it] 50%|█████     | 30/60 [01:02<01:02,  2.08s/it] 52%|█████▏    | 31/60 [01:04<01:00,  2.08s/it] 53%|█████▎    | 32/60 [01:06<00:58,  2.08s/it] 55%|█████▌    | 33/60 [01:08<00:56,  2.08s/it] 57%|█████▋    | 34/60 [01:10<00:53,  2.07s/it] 58%|█████▊    | 35/60 [01:12<00:51,  2.08s/it] 60%|██████    | 36/60 [01:14<00:49,  2.08s/it] 62%|██████▏   | 37/60 [01:16<00:47,  2.08s/it] 63%|██████▎   | 38/60 [01:19<00:45,  2.08s/it] 65%|██████▌   | 39/60 [01:21<00:43,  2.08s/it] 67%|██████▋   | 40/60 [01:23<00:41,  2.08s/it] 68%|██████▊   | 41/60 [01:25<00:39,  2.08s/it] 70%|███████   | 42/60 [01:27<00:37,  2.08s/it] 72%|███████▏  | 43/60 [01:29<00:36,  2.14s/it] 73%|███████▎  | 44/60 [01:31<00:34,  2.17s/it] 75%|███████▌  | 45/60 [01:34<00:33,  2.20s/it] 77%|███████▋  | 46/60 [01:36<00:31,  2.22s/it] 78%|███████▊  | 47/60 [01:38<00:28,  2.23s/it] 80%|████████  | 48/60 [01:40<00:26,  2.23s/it] 82%|████████▏ | 49/60 [01:43<00:24,  2.23s/it] 83%|████████▎ | 50/60 [01:45<00:22,  2.23s/it] 85%|████████▌ | 51/60 [01:47<00:20,  2.22s/it] 87%|████████▋ | 52/60 [01:49<00:17,  2.23s/it] 88%|████████▊ | 53/60 [01:51<00:15,  2.22s/it] 90%|█████████ | 54/60 [01:54<00:13,  2.20s/it] 92%|█████████▏| 55/60 [01:56<00:10,  2.19s/it] 93%|█████████▎| 56/60 [01:58<00:08,  2.17s/it] 95%|█████████▌| 57/60 [02:00<00:06,  2.18s/it] 97%|█████████▋| 58/60 [02:02<00:04,  2.17s/it] 98%|█████████▊| 59/60 [02:04<00:02,  2.14s/it]100%|██████████| 60/60 [02:05<00:00,  1.68s/it]100%|██████████| 60/60 [02:05<00:00,  2.09s/it]
